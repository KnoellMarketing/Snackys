!function(){"use strict";$.snacky&&!$.snacky.checkout&&($.snacky.checkout={});var e=function(){};e.prototype={data:{isLoading:!1,galleryPreviews:4},constructor:e,load:function(){this.adressForm(),this.versand(),this.basics(),this.checkPayPalPlus()},basics:function(){$("input[type=submit],button[type=submit]").on("click",function(){$(this).closest("form").find("input:hidden, select:hidden").each(function(){$(this).removeAttr("required")})}),$("#comment").on("change",function(){$("#comment-hidden").val($(this).val())})},adressForm:function(){this.observePLZ("#postcode","#city","#country"),this.observePLZ("#register-shipping_address-postcode","#register-shipping_address-city","#register-shipping_address-country"),$("#checkout_register_shipping_address").on("change",function(){this.checked?$("#select_shipping_address").hide():$("#select_shipping_address").show()}),$("#checkout_create_account_unreg").on("change",function(){this.checked?$("#create_account_data").show():$("#create_account_data").hide()}),$("input[name=kLieferadresse]").on("change",function(){$(this).val()>0?$("#register_shipping_address").hide():$("#register_shipping_address").show()}),$("#choose-way .step-box").click(function(){$("#choose-way .step-box").removeClass("active"),$(this).addClass("active"),$(this).hasClass("login")?($("#existing-customer").removeClass("hidden"),$("#customer").addClass("hidden")):($("#existing-customer").addClass("hidden"),$("#customer").removeClass("hidden")),$(this).hasClass("reg")?($("#checkout_create_account_unreg").prop("checked",!0),$("#create_account_data").show()):$(this).hasClass("guest")&&($("#checkout_create_account_unreg").prop("checked",!1),$("#create_account_data").hide())}),$("#country").on("change",function(){document.getElementById("register-shipping_address-country")&&(null==document.getElementById("register-shipping_address-country").querySelector('[value="'+$(this).val()+'"]')?($("#checkout_register_shipping_address_div").addClass("hidden"),$("#select_shipping_address").show(),$("#checkout_register_shipping_address").prop("checked",!1)):$("#checkout_register_shipping_address_div").removeClass("hidden"))})},observePLZ:function(e,s,o){$(e).on("change",function(){""==$(s).val()&&$.ajax({url:"io.php",data:{io:JSON.stringify({name:"getCitiesByZip",params:["",$(o).val(),$(e).val()]})}}).done(function(e){1==$(e).length&&""==$(s).val()&&$(s).val(e[0])})})},versand:function(){var e=this;$("input[name=Versandart]").on("change",function(){$("body").addClass("loading"),$.ajax({url:"bestellvorgang.php?isAjax&kVersandart="+$(this).val()}).done(function(s){$("body").removeClass("loading");var o=$.parseHTML(s,document,!0);payments=$(o).find("#fieldset-payment").html(),$("#fieldset-payment").html(payments),e.checkPayPalPlus()}).fail(function(){$("body").removeClass("loading"),console.log("Error loading "+url)})})},checkPayPalPlus:function(){if($("#ppp-modal").length){var e=!0;$(".shipping-payments .btn-primary.submit").each(function(){e?e=!1:$(this).hide()})}else $(".shipping-payments .btn-primary.submit").show()}},$.snacky.checkout=new e,$.snacky.start($.snacky.checkout)}(jQuery),function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(e,s,o,t){var i=[],n=function(){return i.length?i[i.length-1]:null},a=function(){var e,s=!1;for(e=i.length-1;e>=0;e--)i[e].$blocker&&(i[e].$blocker.toggleClass("current",!s).toggleClass("behind",s),s=!0)};e.modal=function(s,o){var t,a;if(this.$body=e("body"),this.options=e.extend({},e.modal.defaults,o),this.options.doFade=!isNaN(parseInt(this.options.fadeDuration,10)),this.$blocker=null,this.options.closeExisting)for(;e.modal.isActive();)e.modal.close();if(i.push(this),s.is("a"))if(a=s.attr("href"),this.anchor=s,/^#/.test(a)){if(this.$elm=e(a),1!==this.$elm.length)return null;this.$body.append(this.$elm),this.open()}else this.$elm=e("<div>"),this.$body.append(this.$elm),t=function(e,s){s.elm.remove()},this.showSpinner(),s.trigger(e.modal.AJAX_SEND),e.get(a).done(function(o){if(e.modal.isActive()){s.trigger(e.modal.AJAX_SUCCESS);var i=n();i.$elm.empty().append(o).on(e.modal.CLOSE,t),i.hideSpinner(),i.open(),s.trigger(e.modal.AJAX_COMPLETE)}}).fail(function(){s.trigger(e.modal.AJAX_FAIL),n().hideSpinner(),i.pop(),s.trigger(e.modal.AJAX_COMPLETE)});else this.$elm=s,this.anchor=s,this.$body.append(this.$elm),this.open()},e.modal.prototype={constructor:e.modal,open:function(){var s=this;this.block(),this.anchor.blur(),this.options.doFade?setTimeout(function(){s.show()},this.options.fadeDuration*this.options.fadeDelay):this.show(),e(o).off("keydown.modal").on("keydown.modal",function(e){var s=n();27===e.which&&s.options.escapeClose&&s.close()}),this.options.clickClose&&this.$blocker.click(function(s){s.target===this&&e.modal.close()})},close:function(){i.pop(),this.unblock(),this.hide(),e.modal.isActive()||e(o).off("keydown.modal")},block:function(){this.$elm.trigger(e.modal.BEFORE_BLOCK,[this._ctx()]),this.$body.css("overflow","hidden"),this.$blocker=e('<div class="'+this.options.blockerClass+' blocker current"></div>').appendTo(this.$body),a(),this.options.doFade&&this.$blocker.css("opacity",0).animate({opacity:1},this.options.fadeDuration),this.$elm.trigger(e.modal.BLOCK,[this._ctx()])},unblock:function(s){!s&&this.options.doFade?this.$blocker.fadeOut(this.options.fadeDuration,this.unblock.bind(this,!0)):(this.$blocker.children().appendTo(this.$body),this.$blocker.remove(),this.$blocker=null,a(),e.modal.isActive()||this.$body.css("overflow",""))},show:function(){this.$elm.trigger(e.modal.BEFORE_OPEN,[this._ctx()]),this.options.showClose&&(this.closeButton=e('<a href="#close-modal" rel="modal:close" class="close-modal '+this.options.closeClass+'">'+this.options.closeText+"</a>"),this.$elm.append(this.closeButton)),this.$elm.addClass(this.options.modalClass).appendTo(this.$blocker),this.options.doFade?this.$elm.css({opacity:0,display:"inline-block"}).animate({opacity:1},this.options.fadeDuration):this.$elm.css("display","inline-block"),this.$elm.trigger(e.modal.OPEN,[this._ctx()])},hide:function(){this.$elm.trigger(e.modal.BEFORE_CLOSE,[this._ctx()]),this.closeButton&&this.closeButton.remove();var s=this;this.options.doFade?this.$elm.fadeOut(this.options.fadeDuration,function(){s.$elm.trigger(e.modal.AFTER_CLOSE,[s._ctx()])}):this.$elm.hide(0,function(){s.$elm.trigger(e.modal.AFTER_CLOSE,[s._ctx()])}),this.$elm.trigger(e.modal.CLOSE,[this._ctx()])},showSpinner:function(){this.options.showSpinner&&(this.spinner=this.spinner||e('<div class="'+this.options.modalClass+'-spinner"></div>').append(this.options.spinnerHtml),this.$body.append(this.spinner),this.spinner.show())},hideSpinner:function(){this.spinner&&this.spinner.remove()},_ctx:function(){return{elm:this.$elm,$elm:this.$elm,$blocker:this.$blocker,options:this.options}}},e.modal.close=function(s){if(e.modal.isActive()){s&&s.preventDefault();var o=n();return o.close(),o.$elm}},e.modal.isActive=function(){return i.length>0},e.modal.getCurrent=n,e.modal.defaults={closeExisting:!0,escapeClose:!0,clickClose:!0,closeText:"Close",closeClass:"",modalClass:"modal",blockerClass:"jquery-modal",spinnerHtml:'<div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div>',showSpinner:!0,showClose:!0,fadeDuration:null,fadeDelay:1},e.modal.BEFORE_BLOCK="modal:before-block",e.modal.BLOCK="modal:block",e.modal.BEFORE_OPEN="modal:before-open",e.modal.OPEN="modal:open",e.modal.BEFORE_CLOSE="modal:before-close",e.modal.CLOSE="modal:close",e.modal.AFTER_CLOSE="modal:after-close",e.modal.AJAX_SEND="modal:ajax:send",e.modal.AJAX_SUCCESS="modal:ajax:success",e.modal.AJAX_FAIL="modal:ajax:fail",e.modal.AJAX_COMPLETE="modal:ajax:complete",e.fn.modal=function(s){return 1===this.length&&new e.modal(this,s),this},e(o).on("click.modal",'a[rel~="modal:close"]',e.modal.close),e(o).on("click.modal",'a[rel~="modal:open"]',function(s){s.preventDefault(),e(this).modal()})});